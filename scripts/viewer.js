Readium.Views.ViewerApplicationView=Backbone.View.extend({el:"body",uiVisible:!1,initialize:function(){this.model.on("change:full_screen",this.toggleFullscreen,this);this.model.on("change:current_theme",this.renderTheme,this);this.model.on("change:toolbar_visible",this.renderPageButtons,this);this.model.on("change:toc_visible",this.renderTocVisible,this);this.optionsPresenter=new Readium.Models.OptionsPresenter({book:this.model});this.optionsView=new Readium.Views.OptionsView({model:this.optionsPresenter});
this.optionsView.render();this.toolbar=new Readium.Views.ToolbarView({model:_book});this.toolbar.render();this.model.on("change:has_toc",this.init_toc,this);this.addGlobalEventHandlers()},toggleFullscreen:function(){this.model.get("full_screen")?document.documentElement.webkitRequestFullScreen():document.webkitCancelFullScreen()},addGlobalEventHandlers:function(){var a=this.model,b=this;window.onresize=function(){a.trigger("repagination_event")};$(document).keydown(function(a){a.which==39&&b.model.goRight();
a.which==37&&b.model.goLeft()});$("#readium-book-view-el").on("swipeleft",function(a){a.preventDefault();b.model.goRight()});$("#readium-book-view-el").on("swiperight",function(a){a.preventDefault();b.model.goLeft()})},render:function(){this.renderTheme();this.renderPageButtons();this.renderTocVisible();return this},renderPageButtons:function(){var a=this.model.get("toolbar_visible");this.$("#prev-page-button").toggle(a);this.$("#next-page-button").toggle(a);return this},renderTheme:function(){var a=
this.model.get("current_theme");this.$el.toggleClass("default-theme","default-theme"===a);this.$el.toggleClass("night-theme","night-theme"===a);this.$el.toggleClass("parchment-theme","parchment-theme"===a);this.$el.toggleClass("ballard-theme","ballard-theme"===a);this.$el.toggleClass("vancouver-theme","vancouver-theme"===a);this.$("#readium-book-view-el").toggleClass("default-theme","default-theme"===a);this.$("#readium-book-view-el").toggleClass("night-theme","night-theme"===a);this.$("#readium-book-view-el").toggleClass("parchment-theme",
"parchment-theme"===a);this.$("#readium-book-view-el").toggleClass("ballard-theme","ballard-theme"===a);this.$("#readium-book-view-el").toggleClass("vancouver-theme","vancouver-theme"===a)},renderTocVisible:function(){this.$el.toggleClass("show-readium-toc",this.model.get("toc_visible"));return this},init_toc:function(){if(this.model.get("has_toc")){var a=this.model.getToc();this.toc=a.TocView();a.fetch()}},events:{"click #prev-page-button":function(){this.model.goLeft()},"click #next-page-button":function(){this.model.goRight()}}});
