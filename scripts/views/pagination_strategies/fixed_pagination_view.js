Readium.Views.FixedPaginationView=Readium.Views.PaginationViewBase.extend({initialize:function(){this.page_template=_.template($("#fixed-page-template").html());this.empty_template=_.template($("#empty-fixed-page-template").html());Readium.Views.PaginationViewBase.prototype.initialize.call(this);this.model.on("change:two_up",this.setUpMode,this);this.model.on("change:meta_size",this.setContainerSize,this)},destruct:function(){console.log("Fixed paginator destructor called");Readium.Views.PaginationViewBase.prototype.destruct.call(this);
this.model.off("change:two_up",this.setUpMode);this.model.off("change:meta_size",this.setUpMode)},render:function(){$("body").addClass("apple-fixed-layout");this.$("#container").html("");this.setContainerSize();return this.renderPages()},setContainerSize:function(){var a=this.model.get("meta_size");if(a&&(this.$el.width(a.width*2),this.$el.height(a.height),!this.zoomed))this.zoomed=!0,setTimeout(function(){$("#page-wrap").zoomAndScale()},1)},addPage:function(a,c){var b=a.getPageView();b.on("iframe_loaded",
function(){this.iframeLoadCallback({srcElement:b.iframe()})},this);var d=a.getPageView().render().el;$(d).attr("id","page-"+c.toString());this.$("#container").append(d);this.changePage();return this},renderPages:function(){this.changePage();return this},changePage:function(){var a=this,c=this.model.get("current_page");this.model.get("two_up");this.$(".fixed-page-wrap").each(function(b){$(this).toggle(a.isPageVisible(b+1,c))})}});
Readium.Views.FixedPageView=Backbone.View.extend({className:"fixed-page-wrap",initialize:function(){this.template=_.template($("#fixed-page-template").html());this.model.on("change",this.render,this)},destruct:function(){this.model.off("change",this.render)},render:function(){var a=this;this.$el.html(this.template(this.model.toJSON()));this.$el.addClass(this.model.getPositionClass());this.$(".content-sandbox").on("load",function(){a.trigger("iframe_loaded")});return this},iframe:function(){return this.$(".content-sandbox")[0]}});
