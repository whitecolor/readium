Readium.Views.TocViewBase=Backbone.View.extend({el:"#readium-toc",initialize:function(){this.model.on("change",this.render,this);this.model.on("change:visible",this.setVisibility,this)},events:{"click a":"handleClick","click #close-toc-button":"closeToc"},setVisibility:function(){this.$el.toggle(this.model.get("visible"))},handleClick:function(a){a.preventDefault();href=$(a.target).attr("href");this.model.handleLink(href)},closeToc:function(a){a.preventDefault();this.model.hide()}});
Readium.Views.NcxTocView=Readium.Views.TocViewBase.extend({initialize:function(){Readium.Views.TocViewBase.prototype.initialize.call(this);this.nav_template=_.template($("#ncx-nav-tempate").html())},render:function(){this.setVisibility();for(var a=$("<ol></ol>"),c=this.model.get("navs"),b=0;b<c.length;b++)a.append(this.nav_template(c[b]));this.$("#toc-body").html("<h2>"+(this.model.get("title")||"Contents")+"</h2>");this.$("#toc-body").append(a);this.$("#toc-body").append("<div id='toc-end-spacer'>");
return this}});Readium.Views.XhtmlTocView=Readium.Views.TocViewBase.extend({render:function(){this.$("#toc-body").html(this.model.get("body").html());this.$("#toc-body").append("<div id='toc-end-spacer'>");return this}});
