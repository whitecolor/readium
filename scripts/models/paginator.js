Readium.Models.Paginator=Backbone.Model.extend({renderToLastPage:!1,initialize:function(){this.rendered_spine_positions=[];this.model=this.get("book")},renderSpineItems:function(a){var b=this.model,c=b.get("spine_position"),e=this;this.rendered_spine_positions=[];this.v&&this.v.destruct();if(this.shouldRenderAsFixed(b.getCurrentSection())){this.should_two_up=b.get("two_up");b.set("two_up",!1);this.v=new Readium.Views.FixedPaginationView({model:b});this.v.render();for(var a=1,d=this.findPrerenderStart();this.shouldPreRender(this.model.getCurrentSection(d));)this.v.addPage(b.getCurrentSection(d),
a),this.rendered_spine_positions.push(c+d),a+=1,d+=1;c=this.rendered_spine_positions.indexOf(c)+1;b.set("num_pages",a-1);b.goToPage(c);setTimeout(function(){e.v.setContainerSize()},5)}else this.shouldScroll()?this.v=new Readium.Views.ScrollingPaginationView({model:b}):(this.should_two_up&&b.set("two_up",!0),this.v=new Readium.Views.ReflowablePaginationView({model:b})),this.v.render(!!a),this.rendered_spine_positions.push(c);return this.rendered_spine_positions},findPrerenderStart:function(){for(var a=
0;this.shouldPreRender(this.model.getCurrentSection(a));)a-=1;return a+1},shouldRenderAsFixed:function(a){return a.isFixedLayout()},shouldPreRender:function(a){return a&&this.shouldRenderAsFixed(a)},shouldScroll:function(){var a=localStorage.READIUM_OPTIONS;return!(a&&JSON.parse(a)||{singleton:{}}).singleton.paginate_everything}});
