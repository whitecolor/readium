Readium.Models.AudioClipPlayer=function(){function m(){function b(){a.removeEventListener("canplay",b);if(e>a.duration)g("File is shorter than specified clipEnd time"),e=a.duration;g("Audio data loaded");j()}g("Loading file "+f);a.setAttribute("src",f);a.addEventListener("canplay",b);a.addEventListener("ended",function(){c!=null&&clearInterval(c);d!=null&&d()})}function j(){if(k==!1&&a.currentTime>h&&a.currentTime<e)i(),a.play();else{a.addEventListener("seeked",b);console.log("setting currentTime from "+
a.currentTime+"to "+h);a.currentTime=h;var b=function(){a.removeEventListener("seeked",b);i();a.play()}}}function i(){c!=null&&clearInterval(c);c=setInterval(function(){a.currentTime>=e&&(clearInterval(c),g("clip done"),d!=null&&d())},11)}function g(a){l&&console.log(a)}var f=null,h=null,e=null,k=!1,a=new Audio,d=null,l=!1,c=null;this.setNotifyClipDone=function(a){d=a};this.setConsoleTrace=function(a){l=a};this.play=function(b,c,d,i){f=b;h=c;e=d;k=i;g("playing "+f+" from "+h+" to "+e);a==null||a.getAttribute("src")!=
f?m():j()};this.isPlaying=function(){return a==null?!1:!a.paused};this.resume=function(){a!=null&&a.play()};this.pause=function(){a!=null&&a.pause()};this.setNotifyOnPause=function(b){a.addEventListener("pause",function(){b()})};this.setNotifyOnPlay=function(b){a.addEventListener("play",function(){b()})};this.getCurrentTime=function(){return a!=null?a.currentTime:0};this.getCurrentSrc=function(){return f};this.setVolume=function(b){a.volume=b<0?0:b>1?1:b}};
